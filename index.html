<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte de la Tunisie 2050 - Répartition des utilisateurs de Souvote</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 100vh; /* Prend toute la hauteur de la fenêtre */
            width: 100vw; /* Prend toute la largeur de la fenêtre */
        }
        .legend {
            background: white;
            padding: 10px;
            line-height: 1.5;
            position: absolute;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            font-family: Arial, sans-serif;
            border-radius: 5px; 
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            max-width: 200px;
        }
        .legend-circle {
            width: 20px; 
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="legend">
        <h4>Légende</h4>
        <p><span class="legend-circle" style="background-color: green;"></span> Moins de 1 million d'utilisateurs</p>
        <p><span class="legend-circle" style="background-color: yellow;"></span> Entre 1 million et 5 millions d'utilisateurs</p>
        <p><span class="legend-circle" style="background-color: red;"></span> Plus de 5 millions d'utilisateurs</p>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialisation de la carte centrée sur la Tunisie avec un niveau de zoom plus élevé
        var map = L.map('map').setView([34.0, 9.0], 7);

        // Ajout de la couche OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Décisions innovantes de 2050
        var mostUpvotedDecisions = [
            "Colonisation des déserts par l'IA", "Foyers autonomes en énergie à hydrogène", 
            "Systèmes éducatifs dirigés par IA", "Tourisme interplanétaire", 
            "Révolution biologique pour la santé", "Médecine personnalisée via ADN", 
            "Villes flottantes et intelligentes", "Agriculture cellulaire", 
            "Économie circulaire intégrée", "Systèmes d'irrigation nano-sensorielles", 
            "Transports électriques volants", "Numérisation quantique des services", 
            "Tourisme durable sur Mars", "Exploitation d'énergies planétaires", 
            "Réseaux d'entreprises décentralisés", "Réseaux d'IA open-source", 
            "Justice par intelligence artificielle", "Souveraineté numérique locale", 
            "Cités intelligentes autosuffisantes", "Protection des écosystèmes sous-marins", 
            "Soutien à l'astro-agriculture", "Développement des communautés spatiales", 
            "Infrastructures vertes avancées", "Accès global à l'eau purifiée"
        ];

        var statesData = [
            { name: "Tunis", lat: 36.8065, lng: 10.1815, users: 8935281 },
            { name: "Ariana", lat: 36.8667, lng: 10.1934, users: 3364242 },
            { name: "Ben Arous", lat: 36.7485, lng: 10.2189, users: 4594126 },
            { name: "Mannouba", lat: 36.8075, lng: 10.1017, users: 1252789 },
            { name: "Bizerte", lat: 37.2744, lng: 9.8739, users: 2545876 },
            { name: "Nabeul", lat: 36.4547, lng: 10.7317, users: 2298351 },
            { name: "Béja", lat: 36.7256, lng: 9.1829, users: 1568423 },
            { name: "Jendouba", lat: 36.5021, lng: 8.7802, users: 1845213 },
            { name: "Zaghouan", lat: 36.402, lng: 10.1423, users: 1956321 },
            { name: "Siliana", lat: 36.0846, lng: 9.3708, users: 1151345 },
            { name: "Le Kef", lat: 36.1826, lng: 8.7149, users: 1495314 },
            { name: "Sousse", lat: 35.8256, lng: 10.6084, users: 4843122 },
            { name: "Monastir", lat: 35.7770, lng: 10.8267, users: 3240450 },
            { name: "Mahdia", lat: 35.5047, lng: 11.0622, users: 2350162 },
            { name: "Kasserine", lat: 35.1676, lng: 8.8365, users: 1390320 },
            { name: "Sidi Bouzid", lat: 35.0382, lng: 9.4842, users: 1760351 },
            { name: "Kairouan", lat: 35.6781, lng: 10.0963, users: 910629 },
            { name: "Gafsa", lat: 34.425, lng: 8.7842, users: 1022051 },
            { name: "Sfax", lat: 34.7398, lng: 10.7603, users: 6003256 },
            { name: "Gabès", lat: 33.8847, lng: 10.0970, users: 3795127 },
            { name: "Médenine", lat: 33.3546, lng: 10.5055, users: 1670128 },
            { name: "Tozeur", lat: 33.9197, lng: 8.1335, users: 827501 },
            { name: "Kebili", lat: 33.7044, lng: 8.9739, users: 1230654 },
            { name: "Tataouine", lat: 32.9297, lng: 10.4518, users: 700564 }
        ];

        // Fonction pour déterminer la couleur en fonction du nombre d'utilisateurs
        function getColor(users) {
            if (users > 5000000) return 'red';
            if (users > 1000000) return 'yellow';
            return 'green';
        }

        // Ajouter un marqueur pour chaque état avec des événements RA et tooltip
        statesData.forEach(function(state, index) {
            var marker = L.circleMarker([state.lat, state.lng], {
                radius: 15,
                fillColor: getColor(state.users),
                color: '#000',
                weight: 1,
                fillOpacity: 0.8
            }).addTo(map);

            // Ajouter une popup avec des détails sur l'état et la stratégie de 2050
            marker.bindPopup(
                `<strong>${state.name}</strong><br>` +
                `Utilisateurs: ${state.users}<br>` +
                `État de participation: ${state.users > 5000000 ? "Très Élevé" : state.users > 1000000 ? "Modéré" : "Faible"}<br>` +
                `Décision Choisie: ${mostUpvotedDecisions[index]}`
            );
        });
    </script>
</body>
</html>
